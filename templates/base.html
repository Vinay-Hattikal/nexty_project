{% load static %} 
<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>{% block title %}NextCareer{% endblock %}</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">

  {# Allow child pages (home.html) to inject page-specific CSS or meta #}
  {% block head %}{% endblock %}

  <style>
    /* ======= Fixed, stable, responsive base styles (CSS-only) ======= */
:root{
  --primary: #0b66c3;
  --primary-600: #0954a8;
  --bg: #f9fafb;
  --surface: #ffffff;
  --white: #fff;
  --muted: #6b7280;
  --text: #0f1724;
  --radius: 10px;
  --gap: 14px;
  --shadow-1: 0 6px 18px rgba(2,6,23,0.06);
  --shadow-2: 0 12px 30px rgba(2,6,23,0.08);
  --focus-ring: 3px solid rgba(11,102,195,0.12);
  --max-width: 1100px;
  --motion: 180ms;
  --easing: cubic-bezier(.2,.9,.3,1);

  /* fixed header height for stable nav */
  --header-h: 64px;
  --header-h-mobile: 56px;
}

/* Reset & base */
*{box-sizing:border-box}
html,body{height:100%;margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial;-webkit-font-smoothing:antialiased}
a{color:inherit;text-decoration:none}
img{max-width:100%;height:auto;display:block}

/* Site nav (fixed & stable) */
.site-nav{
  background:var(--surface);
  box-shadow:var(--shadow-1);
  position:fixed;
  top:0;
  left:0;
  right:0;
  width:100%;
  height: var(--header-h);
  z-index:9999;
  border-bottom:1px solid rgba(15,23,36,0.03);
  backdrop-filter: blur(4px) saturate(110%);
}

/* Nav container — fills header height, no vertical padding drift */
.nav-inner{
  max-width:var(--max-width);
  margin:0 auto;
  height:100%;
  display:flex;
  align-items:center;
  justify-content:space-between;
  gap:var(--gap);
  padding:0 20px;
  border-radius:999px;
}

/* Brand */
.brand, .auth-brand{ font-weight:800; color:var(--primary); text-decoration:none; display:inline-flex; align-items:center; line-height:1; height:100% }
.brand{ font-size:1.15rem; letter-spacing:-0.01em }
.auth-brand{ font-size:1.25rem }

/* Menu toggle */
.menu-toggle{
  display:inline-flex; align-items:center; justify-content:center;
  border:0; background:transparent; font-size:1.25rem; padding:8px; border-radius:8px; cursor:pointer;
  transition: transform var(--motion) var(--easing);
}
.menu-toggle:active{ transform: translateY(1px) }
.menu-toggle:focus{ outline:none; box-shadow:var(--focus-ring) }

/* Desktop links (full-height clickable area, no vertical padding) */
.nav-links{
  display:flex; gap:14px; list-style:none; padding:0; margin:0; align-items:center; height:100%;
}
.nav-links a{
  display:inline-flex; align-items:center; height:100%;
  color:#111827; padding:0 12px; border-radius:8px; font-weight:600;
  transition: background var(--motion) var(--easing), transform var(--motion) var(--easing), color var(--motion) var(--easing);
}
.nav-links a:hover, .nav-links a:focus{
  background:linear-gradient(180deg, rgba(243,246,251,0.95), rgba(241,245,255,0.9));
  color:var(--primary);
  transform: translateY(-2px);
}

/* Actions & CTA (kept compact to not change header height) */
.nav-actions{ display:flex; align-items:center; gap:12px; height:100% }
.nav-link{ color:var(--primary); font-weight:600; padding:0 8px; border-radius:8px; display:inline-flex; align-items:center; height:100% }
.nav-cta{
  background:var(--primary); color:var(--white);
  padding:8px 12px; border-radius:8px; font-weight:700; display:inline-flex; align-items:center; height:38px;
  transition: transform var(--motion) var(--easing), box-shadow var(--motion) var(--easing);
  box-shadow: 0 8px 20px rgba(11,102,195,0.08);
}
.nav-cta:hover, .nav-cta:focus{ transform: translateY(-3px); box-shadow: var(--shadow-2) }
.logout-button{ background:none;border:0;color:var(--primary);font-weight:700;cursor:pointer;padding:0 8px;border-radius:8px; height:38px; display:inline-flex; align-items:center }
.logout-button:hover{ background:rgba(11,102,195,0.06) }

/* Mobile menu (JS toggles display + aria) */
.mobile-menu{
  display:none;
  background:var(--surface);
  box-shadow:0 12px 40px rgba(2,6,23,0.08);
  position:fixed; left:0; right:0; top:var(--header-h);
  z-index:9998; padding:12px; border-top:1px solid rgba(15,23,36,0.04);
  border-radius:0 0 12px 12px;
  transform-origin: top center; transform: translateY(0) scaleY(1); opacity:1;
}
.mobile-menu[aria-hidden="true"]{ display:none }
.mobile-menu a{ display:block; padding:10px; border-radius:8px; color:#111827; transition: background var(--motion) var(--easing) }
.mobile-menu a:hover, .mobile-menu a:focus{ background:linear-gradient(180deg, rgba(243,246,251,0.95), rgba(241,245,255,0.9)); color:var(--primary) }

/* Auth header */
.auth-header{ background:transparent; padding:18px 20px; display:flex; align-items:center; justify-content:center; }

/* Messages */
.messages-wrap{ max-width:var(--max-width); margin:18px auto; padding:0 20px }
.messages{ list-style:none; padding:0; margin:0; display:flex; flex-direction:column; gap:8px }
.message{
  padding:10px 12px; border-radius:8px; background:var(--surface);
  border-left:4px solid rgba(11,61,145,0.12); color:var(--primary-600);
  box-shadow:0 6px 14px rgba(2,6,23,0.03);
}

/* Main — give space under fixed header so hero doesn’t sit under it */
main{
  max-width:var(--max-width);
  margin:28px auto;
  padding: calc(var(--header-h) + 20px) 20px 0;  /* top padding includes header height */
  min-height:50vh;
}

/* Footer */
.site-footer{ background:transparent; padding:30px 0; color:var(--muted); text-align:center; font-size:0.95rem; margin-top:40px }

/* Responsive */
@media (max-width: 1024px){
  .nav-inner{ padding:0 16px }
  main{ padding: calc(var(--header-h) + 12px) 16px 0; margin:20px auto }
}
@media (max-width: 768px){
  :root{ --header-h: 56px; }
  .nav-links{ display:none }
  .nav-actions{ display:none }
  .menu-toggle{ display:inline-flex }
  .brand{ font-size:1.05rem }
  .messages-wrap{ padding:0 16px }
}
@media (min-width: 769px){
  .menu-toggle{ display:none }
}

/* Focus styles */
:focus{ outline:none }
:focus-visible{ outline: var(--focus-ring); outline-offset: 3px; border-radius:6px }

/* Reduced motion */
@media (prefers-reduced-motion: reduce){
  :root{ --motion: 1ms }
  .menu-toggle, .nav-links a, .nav-cta, .mobile-menu{ transition:none !important; transform:none !important; animation:none !important }
}

  </style>
</head>
<body>
  {# Determine if we're on auth pages (login/signup) and show a minimal header instead #}
  {% comment %}
    Adjust the two url names below if your login/signup URLs have different names.
    e.g. if your login URL name is 'accounts_login', replace 'login' with 'accounts_login'.
  {% endcomment %}
  {% if request.resolver_match and request.resolver_match.url_name != 'login' and request.resolver_match.url_name != 'signup' %}
    <header>
      <nav class="site-nav" role="navigation" aria-label="Main">
        <div class="nav-inner">
          <a class="brand" href="{% url 'home' %}">NextCareer</a>

          <button id="menu-toggle" class="menu-toggle" aria-expanded="false" aria-controls="mobile-menu" aria-label="Open navigation">
            ☰
          </button>

          <ul class="nav-links" id="desktop-links" role="menubar">
            <li role="none"><a role="menuitem" href="{% url 'home' %}#features">Features</a></li>
            <li role="none"><a role="menuitem" href="{% url 'home' %}#how-it-works">How it works</a></li>
            <li role="none"><a role="menuitem" href="{% url 'home' %}#testimonials">Testimonials</a></li>
            <!-- <li role="none"><a role="menuitem" href="{% url 'home' %}#contact">Contact</a></li> -->
          </ul>

          <div class="nav-actions" id="nav-actions">
            {% if user.is_authenticated %}
              <span class="nav-welcome">Hi, {{ user.first_name|default:user.username }}</span>
              <a class="nav-btn nav-link" href="{% url 'dashboard-redirect' %}">Dashboard</a>

              <form method="post" action="{% url 'logout' %}" class="logout-form" style="display:inline;">
                {% csrf_token %}
                <button type="submit" class="logout-button" style="background:none;border:0;color:var(--primary);font-weight:700;cursor:pointer">Logout</button>
              </form>
            {% else %}
              <a class="nav-link" href="{% url 'login' %}">Login</a>
              <a class="nav-cta" href="{% url 'signup' %}">Signup</a>
            {% endif %}
          </div>
        </div>
      </nav>

      {# mobile menu (toggled by JS) #}
      <div id="mobile-menu" class="mobile-menu" aria-hidden="true">
        <a href="{% url 'home' %}#features">Features</a>
        <a href="{% url 'home' %}#how-it-works">How it works</a>
        <a href="{% url 'home' %}#testimonials">Testimonials</a>
        <a href="{% url 'home' %}#contact">Contact</a>
        {% if user.is_authenticated %}
          <a href="{% url 'dashboard-redirect' %}">Dashboard</a>
          <form method="post" action="{% url 'logout' %}" class="logout-form" style="margin-top:8px;">
            {% csrf_token %}
            <button type="submit" class="logout-button" style="background:none;border:0;color:var(--primary);font-weight:700;cursor:pointer">Logout</button>
          </form>
        {% else %}
          <a href="{% url 'login' %}">Login</a>
          <a href="{% url 'signup' %}" class="mobile-cta" style="display:inline-block;margin-top:6px;padding:8px 10px;border-radius:8px;background:var(--primary);color:#fff;text-decoration:none;">Signup</a>
        {% endif %}
      </div>
    </header>
  {% else %}
    {# Minimal header for auth pages: only logo/brand centered (less distracting) #}
    <header class="auth-header" role="banner">
      <a class="auth-brand" href="{% url 'home' %}">NextCareer</a>
    </header>
  {% endif %}

  {# messages (flash alerts) #}
  <div class="messages-wrap">
    {% if messages %}
      <ul class="messages" role="status" aria-live="polite">
        {% for message in messages %}
          <li class="message {{ message.tags }}">{{ message }}</li>
        {% endfor %}
      </ul>
    {% endif %}
  </div>

  <main id="main">
    {% block content %}{% endblock %}
  </main>

  <footer class="site-footer" role="contentinfo">
    <div class="footer-inner">
      &copy; {% now "Y" %} NextCareer — built with care.
    </div>
  </footer>

  {# Small JS to toggle mobile menu and manage aria attributes; non-blocking and unobtrusive #}
  <script>
    (function(){
      const toggle = document.getElementById('menu-toggle');
      const mobile = document.getElementById('mobile-menu');
      if (!toggle || !mobile) return;

      function setOpen(open){
        toggle.setAttribute('aria-expanded', open ? 'true' : 'false');
        mobile.setAttribute('aria-hidden', open ? 'false' : 'true');
        if (open) {
          mobile.style.display = 'block';
          // focus first link for keyboard users
          const first = mobile.querySelector('a, button');
          if (first) first.focus();
        } else {
          mobile.style.display = 'none';
        }
      }

      // initial state
      setOpen(false);

      toggle.addEventListener('click', function(e){
        e.stopPropagation();
        const isOpen = toggle.getAttribute('aria-expanded') === 'true';
        setOpen(!isOpen);
      });

      // close on escape
      document.addEventListener('keydown', function(e){
        if (e.key === 'Escape') setOpen(false);
      });

      // close when clicking outside
      document.addEventListener('click', function(e){
        if (!mobile.contains(e.target) && !toggle.contains(e.target)) {
          setOpen(false);
        }
      });

      // improve touch experience: close menu on link click
      mobile.querySelectorAll('a').forEach(a => a.addEventListener('click', () => setOpen(false)));

      // ensure mobile menu hidden on resize to larger screens
      window.addEventListener('resize', function(){
        if (window.innerWidth > 768) {
          setOpen(false);
          mobile.style.display = '';
        }
      });
    })();
  </script>

  {% block scripts %}{% endblock %}
</body>
</html>