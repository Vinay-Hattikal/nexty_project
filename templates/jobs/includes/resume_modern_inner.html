{% load static %}
<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>{{ resume.title|default:"Resume" }}</title>

  <style>
    /* === Classic Resume - pisa-friendly === */
    @page { size: A4; margin: 15mm 18mm 15mm 18mm; }

    html, body {
      margin: 0;
      padding: 0;
      font-family: "Georgia", "Times New Roman", serif;
      color: #222;
      font-size: 11pt;
      line-height: 1.35;
      background: #fff;
    }

    .page {
      max-width: 800px;
      margin: 0 auto;
      padding: 6px 12px;
      box-sizing: border-box;
    }

    /* Header */
    .header {
      text-align: center;
      margin-bottom: 12px;
    }

    .name {
      font-size: 22pt;
      font-weight: 700;
      letter-spacing: 0.3px;
      color: #0b3d91;
      margin: 0 0 4px 0;
    }

    .headline {
      font-size: 10.5pt;
      color: #444;
      margin: 0 0 8px 0;
    }

    .contact {
      display: block;
      font-size: 9.5pt;
      color: #333;
      margin-top: 4px;
    }

    .contact span {
      display: inline-block;
      margin: 0 6px;
    }

    hr.rule {
      border: none;
      border-top: 1px solid #ddd;
      margin: 12px 0 16px 0;
    }

    /* Sections */
    .section {
      margin: 12px 0 14px 0;
      clear: both;
      page-break-inside: avoid;
    }

    .section-title {
      font-weight: 700;
      font-size: 11pt;
      margin: 0 0 8px 0;
      color: #0b3d91;
      letter-spacing: 0.3px;
      text-transform: uppercase;
      border-bottom: 1px solid #ededed;
      padding-bottom: 4px;
    }

    /* Row layout using floats (pisa-friendly) */
    .row { margin-bottom: 8px; clear: both; zoom:1; } /* zoom:1 for hasLayout in some renderers */
    .main { display: block; float: left; width: 62%; box-sizing: border-box; }
    .datecol { display: block; float: right; width: 34%; box-sizing: border-box; text-align: right; font-size: 9.5pt; color: #666; white-space: nowrap; }

    /* Titles & subtitles */
    .title {
      font-weight: 700;
      font-size: 11pt;
      margin: 0 0 3px 0;
      color: #111;
    }

    .sub {
      font-size: 10pt;
      color: #333;
      margin: 0 0 6px 0;
    }

    .para {
      font-size: 10pt;
      line-height: 1.34;
      margin: 4px 0 8px 0;
      text-align: justify;
      white-space: pre-wrap;
      word-break: break-word;
    }

    ul.bullets {
      margin: 6px 0 8px 18px;
      font-size: 10pt;
      line-height: 1.28;
      padding-left: 0;
    }

    ul.bullets li {
      margin-bottom: 5px;
      text-align: justify;
      list-style-type: disc;
    }

    .small { font-size: 10pt; color: #333; }

    /* Make sure floats clear after each row block */
    .row:after { content: ''; display: block; clear: both; }

    /* Avoid cutting small blocks across pages */
    .item { page-break-inside: avoid; }

    /* Simple fallback for long skill lines */
    .skills { white-space: normal; word-break: break-word; }

  </style>
</head>

<body>
{% with rd=data|default:resume.data %}
  <div class="page">
    <!-- HEADER -->
    <header class="header">
      {% if rd.personal and rd.personal.full_name %}
        <div class="name">{{ rd.personal.full_name }}</div>
      {% else %}
        <div class="name">{{ resume.owner.get_full_name|default:resume.owner.username }}</div>
      {% endif %}

      {% if rd.personal and rd.personal.headline %}
        <div class="headline">{{ rd.personal.headline }}</div>
      {% endif %}

      <div class="contact">
        {% if rd.personal and rd.personal.email %}<span>{{ rd.personal.email }}</span>{% endif %}
        {% if rd.personal and rd.personal.phone %}<span>{{ rd.personal.phone }}</span>{% endif %}
        {% if rd.personal and rd.personal.linkedin %}<span>{{ rd.personal.linkedin }}</span>{% endif %}
        {% if rd.personal and rd.personal.location %}<span>{{ rd.personal.location }}</span>{% endif %}
      </div>
    </header>

    <hr class="rule">

    <!-- SUMMARY -->
    {% if rd.summary %}
      <section class="section">
        <div class="section-title">Profile</div>
        <div class="para">{{ rd.summary|linebreaksbr }}</div>
      </section>
    {% endif %}

    <!-- EDUCATION -->
    {% if rd.education and rd.education|length > 0 %}
      <section class="section">
        <div class="section-title">Education</div>
        {% for e in rd.education %}
          <div class="row item">
            <div class="main">
              <div class="title">{{ e.school }}</div>
              <div class="sub">
                {% if e.degree %}{{ e.degree }}{% endif %}
                {% if e.details %} — {{ e.details }}{% endif %}
              </div>
            </div>
            <div class="datecol">{% if e.duration %}{{ e.duration }}{% endif %}</div>
          </div>
        {% endfor %}
      </section>
    {% endif %}

    <!-- PROJECTS -->
    {% if rd.projects and rd.projects|length > 0 %}
      <section class="section">
        <div class="section-title">Projects</div>
        {% for p in rd.projects %}
          <div class="row item">
            <div class="main">
              {% if p.title %}<div class="title">{{ p.title }}</div>{% endif %}
              {% if p.tech %}<div class="sub">{{ p.tech }}</div>{% endif %}
              {% if p.description_lines and p.description_lines|length > 0 %}
                <ul class="bullets">
                  {% for line in p.description_lines %}
                    {% if line %}<li>{{ line }}</li>{% endif %}
                  {% endfor %}
                </ul>
              {% elif p.description %}
                <div class="para">{{ p.description|linebreaksbr }}</div>
              {% endif %}
            </div>
            <div class="datecol">{% if p.duration %}{{ p.duration }}{% endif %}</div>
          </div>
        {% endfor %}
      </section>
    {% endif %}

    <!-- EXPERIENCE (if present in data; placed after Projects by default) -->
    {% if rd.experience and rd.experience|length > 0 %}
      <section class="section">
        <div class="section-title">Experience</div>
        {% for exp in rd.experience %}
          <div class="row item">
            <div class="main">
              <div class="title">{{ exp.title|default:exp.company }}</div>
              <div class="sub">{{ exp.company }}{% if exp.location %} — {{ exp.location }}{% endif %}</div>
              {% if exp.description_lines and exp.description_lines|length > 0 %}
                <ul class="bullets">
                  {% for b in exp.description_lines %}
                    {% if b %}<li>{{ b }}</li>{% endif %}
                  {% endfor %}
                </ul>
              {% elif exp.description %}
                <div class="para">{{ exp.description|linebreaksbr }}</div>
              {% endif %}
            </div>
            <div class="datecol">{% if exp.duration %}{{ exp.duration }}{% elif exp.start_date %}{{ exp.start_date }}{% endif %}{% if exp.end_date %} – {{ exp.end_date }}{% endif %}</div>
          </div>
        {% endfor %}
      </section>
    {% endif %}

    <!-- SKILLS -->
    {% if rd.skills and rd.skills|length > 0 %}
      <section class="section">
        <div class="section-title">Skills</div>
        <div class="para skills">{{ rd.skills|join:", " }}</div>
      </section>
    {% endif %}

    <!-- ACHIEVEMENTS -->
    {% if rd.achievements %}
      <section class="section">
        <div class="section-title">Achievements</div>
        <div class="para">{{ rd.achievements|linebreaksbr }}</div>
      </section>
    {% endif %}

    <!-- CUSTOM SECTIONS -->
    {% if rd.custom_sections and rd.custom_sections|length > 0 %}
      {% for c in rd.custom_sections %}
        {% if c.title or c.content %}
          <section class="section">
            <div class="section-title">{{ c.title }}</div>
            <div class="para">{{ c.content|linebreaksbr }}</div>
          </section>
        {% endif %}
      {% endfor %}
    {% endif %}
  </div>
{% endwith %}
</body>
</html>
